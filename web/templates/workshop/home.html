{% extends 'base.html' %}
{% block title %}工坊 - 首页{% endblock %}
{% block content %}
<div class="container mt-4">
  <nav aria-label="breadcrumb" class="mb-3">
    <ol class="breadcrumb">
      <li class="breadcrumb-item"><a href="/">首页</a></li>
      <li class="breadcrumb-item active">工坊</li>
    </ol>
  </nav>
  <h2 class="mb-4">工坊</h2>
  <div class="row mb-4" id="dashboard-row">
    <div class="col-md-6 mb-2">
      <div class="card text-center border-info">
        <div class="card-body">
          <h5 class="card-title">已发布作品总数</h5>
          <p class="display-5 fw-bold text-info" id="total-works">--</p>
        </div>
      </div>
    </div>
    <div class="col-md-6 mb-2">
      <div class="card text-center border-success">
        <div class="card-body">
          <h5 class="card-title">发布过作品的用户数</h5>
          <p class="display-5 fw-bold text-success" id="user-count">--</p>
        </div>
      </div>
    </div>
  </div>
  <div class="row">
    <script>
    fetch('/workshop/api/dashboard').then(r=>r.json()).then(data=>{
      if(data.success) {
        document.getElementById('total-works').innerText = data.total_works;
        document.getElementById('user-count').innerText = data.user_count;
      }
    });
    </script>
    <div class="col-md-4 mb-3">
      <div class="card h-100">
        <div class="card-body d-flex flex-column justify-content-between">
          <h5 class="card-title">关于工坊</h5>
          <p class="card-text">了解工坊的功能与协作方式。</p>
          <a href="{{ url_for('workshop.about') }}" class="btn btn-outline-primary mt-auto">进入</a>
        </div>
      </div>
    </div>
    {% if current_user.is_authenticated and current_user.is_admin %}
    <div class="col-md-4 mb-3">
      <div class="card h-100 border-danger">
        <div class="card-body d-flex flex-column justify-content-between">
          <h5 class="card-title text-danger">工坊管理后台</h5>
          <p class="card-text">管理作品、切换模式、调整热度参数。</p>
          <a href="{{ url_for('workshop_admin.admin_dashboard') }}" class="btn btn-danger mt-auto">进入后台</a>
        </div>
      </div>
    </div>
    {% endif %}
    <div class="col-md-4 mb-3">
      <div class="card h-100">
        <div class="card-body d-flex flex-column justify-content-between">
          <h5 class="card-title">发现</h5>
          <p class="card-text">浏览最新与热门作品，搜索与阅读。</p>
          <a href="{{ url_for('workshop.discover') }}" class="btn btn-outline-success mt-auto">进入</a>
        </div>
      </div>
    </div>
    <div class="col-md-4 mb-3">
      <div class="card h-100">
        <div class="card-body d-flex flex-column justify-content-between">
          <h5 class="card-title">我的作品</h5>
          <p class="card-text">管理和编辑你已发布的所有作品。</p>
          <a href="{{ url_for('workshop.my_works_page') }}" class="btn btn-outline-info mt-auto">进入</a>
        </div>
      </div>
    </div>
    <div class="col-md-4 mb-3">
      <div class="card h-100">
        <div class="card-body d-flex flex-column justify-content-between">
          <h5 class="card-title">创作</h5>
          <p class="card-text">进入创作空间，撰写与发布你的作品。</p>
          <a href="{{ url_for('workshop.create') }}" class="btn btn-outline-warning mt-auto">进入</a>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}
